package team050;

public class StringHeap {
    // The concept is to use stringbuilder and its nice .index method
    private StringBuilder data;

    /*
     * The structure of data is X1YX2YX3YX4YX5YX6YX7YX8YX9YXZijY10Y11Y12
     * 
     * To get the least, get the index of Z which is preceded by value and followed by char(y)
     * char(x)
     */

    public StringHeap(int _x, int _y) {
        data = new StringBuilder(
                "X0YWWX1YWWX2YWWX3YWWX4YWWX5YWWX6YWWX7YWWX8YWWX9YWWX10YWX11YWX12YWX13YWX14YWX15YWX16YWX17YWX18YWX19YWX20YWX21YWX22YWX23YWX24YWX25YWX26YWX27YWX28YWX29YWX30YWX31YWX32YWX33YWX34YWX35YWX36YWX37YWX38YWX39YWX40YWX41YWX42YWX43YWX44YWX45YWX46YWX47YWX48YWX49YWX50YWX51YWX52YWX53YWX54YWX55YWX56YWX57YWX58YWX59YWX60YWX61YWX62YWX63YWX64YWX65YWX66YWX67YWX68YWX69YWX70YWX71YWX72YWX73YWX74YWX75YWX76YWX77YWX78YWX79YWX80YWX81YWX82YWX83YWX84YWX85YWX86YWX87YWX88YWX89YWX90YWX91YWX92YWX93YWX94YWX95YWX96YWX97YWX98YWX99YWX100YX101YX102YX103YX104YX105YX106YX107YX108YX109YX110YX111YX112YX113YX114YX115YX116YX117YX118YX119YX120YX121YX122YX123YX124YX125YX126YX127YX128YX129YX130YX131YX132YX133YX134YX135YX136YX137YX138YX139YX140YX141YX142YX143YX144YX145YX146YX147YX148YX149YX150YX151YX152YX153YX154YX155YX156YX157YX158YX159YX160YX161YX162YX163YX164YX165YX166YX167YX168YX169YX170YX171YX172YX173YX174YX175YX176YX177YX178YX179YX180YX181YX182YX183YX184YX185YX186YX187YX188YX189YX190YX191YX192YX193YX194YX195YX196YX197YX198YX199YX200YX201YX202YX203YX204YX205YX206YX207YX208YX209YX210YX211YX212YX213YX214YX215YX216YX217YX218YX219YX220YX221YX222YX223YX224YX225YX226YX227YX228YX229YX230YX231YX232YX233YX234YX235YX236YX237YX238YX239YX240YX241YX242YX243YX244YX245YX246YX247YX248YX249YX250YX251YX252YX253YX254YX255YX256YX257YX258YX259YX260YX261YX262YX263YX264YX265YX266YX267YX268YX269YX270YX271YX272YX273YX274YX275YX276YX277YX278YX279YX280YX281YX282YX283YX284YX285YX286YX287YX288YX289YX290YX291YX292YX293YX294YX295YX296YX297YX298YX299YX300YX301YX302YX303YX304YX305YX306YX307YX308YX309YX310YX311YX312YX313YX314YX315YX316YX317YX318YX319YX320YX321YX322YX323YX324YX325YX326YX327YX328YX329YX330YX331YX332YX333YX334YX335YX336YX337YX338YX339YX340YX341YX342YX343YX344YX345YX346YX347YX348YX349YX350YX351YX352YX353YX354YX355YX356YX357YX358YX359YX360YX361YX362YX363YX364YX365YX366YX367YX368YX369YX370YX371YX372YX373YX374YX375YX376YX377YX378YX379YX380YX381YX382YX383YX384YX385YX386YX387YX388YX389YX390YX391YX392YX393YX394YX395YX396YX397YX398YX399YX400YX401YX402YX403YX404YX405YX406YX407YX408YX409YX410YX411YX412YX413YX414YX415YX416YX417YX418YX419YX420YX421YX422YX423YX424YX425YX426YX427YX428YX429YX430YX431YX432YX433YX434YX435YX436YX437YX438YX439YX440YX441YX442YX443YX444YX445YX446YX447YX448YX449YX450YX451YX452YX453YX454YX455YX456YX457YX458YX459YX460YX461YX462YX463YX464YX465YX466YX467YX468YX469YX470YX471YX472YX473YX474YX475YX476YX477YX478YX479YX480YX481YX482YX483YX484YX485YX486YX487YX488YX489YX490YX491YX492YX493YX494YX495YX496YX497YX498YX499YX500YX501YX502YX503YX504YX505YX506YX507YX508YX509YX510YX511YX512YX513YX514YX515YX516YX517YX518YX519YX520YX521YX522YX523YX524YX525YX526YX527YX528YX529YX530YX531YX532YX533YX534YX535YX536YX537YX538YX539YX540YX541YX542YX543YX544YX545YX546YX547YX548YX549YX550YX551YX552YX553YX554YX555YX556YX557YX558YX559YX560YX561YX562YX563YX564YX565YX566YX567YX568YX569YX570YX571YX572YX573YX574YX575YX576YX577YX578YX579YX580YX581YX582YX583YX584YX585YX586YX587YX588YX589YX590YX591YX592YX593YX594YX595YX596YX597YX598YX599YX600YX601YX602YX603YX604YX605YX606YX607YX608YX609YX610YX611YX612YX613YX614YX615YX616YX617YX618YX619YX620YX621YX622YX623YX624YX625YX626YX627YX628YX629YX630YX631YX632YX633YX634YX635YX636YX637YX638YX639YX640YX641YX642YX643YX644YX645YX646YX647YX648YX649YX650YX651YX652YX653YX654YX655YX656YX657YX658YX659YX660YX661YX662YX663YX664YX665YX666YX667YX668YX669YX670YX671YX672YX673YX674YX675YX676YX677YX678YX679YX680YX681YX682YX683YX684YX685YX686YX687YX688YX689YX690YX691YX692YX693YX694YX695YX696YX697YX698YX699YX700YX701YX702YX703YX704YX705YX706YX707YX708YX709YX710YX711YX712YX713YX714YX715YX716YX717YX718YX719YX720YX721YX722YX723YX724YX725YX726YX727YX728YX729YX730YX731YX732YX733YX734YX735YX736YX737YX738YX739YX740YX741YX742YX743YX744YX745YX746YX747YX748YX749YX750YX751YX752YX753YX754YX755YX756YX757YX758YX759YX760YX761YX762YX763YX764YX765YX766YX767YX768YX769YX770YX771YX772YX773YX774YX775YX776YX777YX778YX779YX780YX781YX782YX783YX784YX785YX786YX787YX788YX789YX790YX791YX792YX793YX794YX795YX796YX797YX798YX799YX800YX801YX802YX803YX804YX805YX806YX807YX808YX809YX810YX811YX812YX813YX814YX815YX816YX817YX818YX819YX820YX821YX822YX823YX824YX825YX826YX827YX828YX829YX830YX831YX832YX833YX834YX835YX836YX837YX838YX839YX840YX841YX842YX843YX844YX845YX846YX847YX848YX849YX850YX851YX852YX853YX854YX855YX856YX857YX858YX859YX860YX861YX862YX863YX864YX865YX866YX867YX868YX869YX870YX871YX872YX873YX874YX875YX876YX877YX878YX879YX880YX881YX882YX883YX884YX885YX886YX887YX888YX889YX890YX891YX892YX893YX894YX895YX896YX897YX898YX899YX900YX901YX902YX903YX904YX905YX906YX907YX908YX909YX910YX911YX912YX913YX914YX915YX916YX917YX918YX919YX920YX921YX922YX923YX924YX925YX926YX927YX928YX929YX930YX931YX932YX933YX934YX935YX936YX937YX938YX939YX940YX941YX942YX943YX944YX945YX946YX947YX948YX949YX950YX951YX952YX953YX954YX955YX956YX957YX958YX959YX960YX961YX962YX963YX964YX965YX966YX967YX968YX969YX970YX971YX972YX973YX974YX975YX976YX977YX978YX979YX980YX981YX982YX983YX984YX985YX986YX987YX988YX989YX990YX991YX992YX993YX994YX995YX996YX997YX998YX999Y");
        for (char x = 1; x <= _x; x++) {
            String a = "Z" + x;
            for (char y = 1; y <= _y; y++) {
                data.append(a + y);
            }
        }
    }

    public int xyToInt(char x, char y) {
        return 100 * x + y - 101;
    }

    public int getMinVal() {
        int indexOfKey = data.indexOf("Z");
        int startOfNumber = data.lastIndexOf("X", indexOfKey);
        int endOfNumber = data.indexOf("Y", startOfNumber);
        return Integer.parseInt(data.substring(startOfNumber + 1, endOfNumber));
    }

    public int extractMin() {
        // TODO: This is always called after getMinVal, so not repeat indexof z
        // Instead, combine and store in static
        int minIndex = data.indexOf("Z");
        char x = data.charAt(minIndex + 1);
        char y = data.charAt(minIndex + 2);
        data.delete(minIndex, minIndex + 3);
        return xyToInt(x, y);
    }

    public String keyToString(int key) {
        key += 101;
        int y = key % 100;
        int x = key / 100;
        return "Z" + (char) x + (char) y;
    }

    public void decreaseKey(int key, int newValue) {
        // Remove the old
        String str = keyToString(key);
        int keyIndex = data.indexOf(str);
        data.delete(keyIndex, keyIndex + 3);

        // Input the new
        int startOfInsert = data.indexOf("X" + Integer.toString(newValue) + "Y");
        data.insert(startOfInsert + 5, str);
    }

    public int getVal(int key) {
        String str = keyToString(key);
        int indexOfKey = data.indexOf(str);
        int startOfNumber = data.lastIndexOf("X", indexOfKey);
        int endOfNumber = data.indexOf("Y", startOfNumber);
        return Integer.parseInt(data.substring(startOfNumber + 1, endOfNumber));
    }
}
